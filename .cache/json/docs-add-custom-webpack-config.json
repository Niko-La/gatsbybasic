{"data":{"markdownRemark":{"html":"<p><em>Before creating custom webpack configuration, check to see if there‚Äôs a Gatsby\nplugin already built that handles your use case in the\n<a href=\"/docs/plugins/\">plugins section</a>. If there‚Äôs not yet one and your use case is a\ngeneral one, we highly encourage you to contribute back your plugin to the\nGatsby repo so it‚Äôs available to others (including your future self üòÄ).</em></p>\n<p>To add custom webpack configurations, create (if there‚Äôs not one already) a\n<code class=\"language-text\">gatsby-node.js</code> file in your root directory. Inside this file, export a\nfunction called <code class=\"language-text\">modifyWebpackConfig</code>.</p>\n<p>When Gatsby creates its webpack config, this function will be called allowing\nyou to modify the default webpack config using\n<a href=\"https://github.com/lewie9021/webpack-configurator\">webpack-configurator</a>.</p>\n<p>Gatsby does multiple webpack builds with somewhat different configuration. We\ncall each build type a ‚Äústage‚Äù. The following stages exist:</p>\n<ol>\n<li>develop: when running the <code class=\"language-text\">gatsby develop</code> command. Has configuration for hot\nreloading and CSS injection into page</li>\n<li>develop-html: same as develop but without react-hmre in the babel config for\nrendering the HTML component.</li>\n<li>build-css: production build of CSS</li>\n<li>build-html: production build static HTML pages</li>\n<li>build-javascript: production JavaScript build. Creates route bundles as well\nas a <code class=\"language-text\">commons</code> and <code class=\"language-text\">app bundle</code>.</li>\n</ol>\n<p>Check\n<a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/utils/webpack.config.js\">webpack.config.js</a>\nfor the source.</p>\n<p>There are many plugins in the Gatsby repo using this API to look to for examples\ne.g. <a href=\"/packages/gatsby-plugin-sass/\">Sass</a>,\n<a href=\"/packages/gatsby-plugin-typescript/\">Typescript</a>,\n<a href=\"/packages/gatsby-plugin-glamor/\">Glamor</a>, and many more!</p>\n<h2 id=\"modifying-the-babel-loader\"><a href=\"#modifying-the-babel-loader\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Modifying the babel loader</h2>\n<p>Manually allow tweaking of include + exclude of babel loader.</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> generateBabelConfig <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gatsby/dist/utils/babel-config\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">modifyWebpackConfig</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> config<span class=\"token punctuation\">,</span> stage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> program <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    directory<span class=\"token punctuation\">:</span> __dirname<span class=\"token punctuation\">,</span>\n    browserslist<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"> 1%\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"last 2 versions\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"IE >= 9\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token function\">generateBabelConfig</span><span class=\"token punctuation\">(</span>program<span class=\"token punctuation\">,</span> stage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>babelConfig <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    config<span class=\"token punctuation\">.</span><span class=\"token function\">removeLoader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">loader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"js\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      test<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\.jsx?$/</span><span class=\"token punctuation\">,</span>\n      exclude<span class=\"token punctuation\">:</span> modulePath <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n          <span class=\"token regex\">/node_modules/</span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>modulePath<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n          <span class=\"token operator\">!</span><span class=\"token regex\">/node_modules\\/(swiper|dom7)/</span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>modulePath<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      loader<span class=\"token punctuation\">:</span> <span class=\"token string\">\"babel\"</span><span class=\"token punctuation\">,</span>\n      query<span class=\"token punctuation\">:</span> babelConfig<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n      </div>\n<h2 id=\"example\"><a href=\"#example\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Example</h2>\n<p>Here is an example that configures <strong>flexboxgrid</strong> when processing css files. Add this in <code class=\"language-text\">gatsby-node.js</code>:</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">modifyWebpackConfig</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> config<span class=\"token punctuation\">,</span> stage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>stage<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"develop\"</span><span class=\"token punctuation\">:</span>\n      config<span class=\"token punctuation\">.</span><span class=\"token function\">loader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"css\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        include<span class=\"token punctuation\">:</span> <span class=\"token regex\">/flexboxgrid/</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"build-css\"</span><span class=\"token punctuation\">:</span>\n      config<span class=\"token punctuation\">.</span><span class=\"token function\">loader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"css\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        include<span class=\"token punctuation\">:</span> <span class=\"token regex\">/flexboxgrid/</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"build-html\"</span><span class=\"token punctuation\">:</span>\n      config<span class=\"token punctuation\">.</span><span class=\"token function\">loader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"css\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        include<span class=\"token punctuation\">:</span> <span class=\"token regex\">/flexboxgrid/</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token string\">\"build-javascript\"</span><span class=\"token punctuation\">:</span>\n      config<span class=\"token punctuation\">.</span><span class=\"token function\">loader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"css\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        include<span class=\"token punctuation\">:</span> <span class=\"token regex\">/flexboxgrid/</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> config<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n      </div>","excerpt":"Before creating custom webpack configuration, check to see if there‚Äôs a Gatsby\nplugin already built that handles your use case in the‚Ä¶","timeToRead":2,"fields":{"slug":"/docs/add-custom-webpack-config/","anchor":"add-custom-webpack-config"},"frontmatter":{"title":"Add Custom webpack Config"},"parent":{"__typename":"File","relativePath":"docs/add-custom-webpack-config.md"}}},"pathContext":{"slug":"/docs/add-custom-webpack-config/"}}